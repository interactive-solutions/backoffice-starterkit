cache:
  paths:
    - node_modules/
stages:
  - test
  - build
  - deploy
test:
  stage: test
  script:
    - yarn install --production=false --silent --no-progress
    - yarn run lint
build:
  stage: build
  script:
    - yarn install --production=false --silent --no-progress
    - yarn run build
  artifacts:
    paths:
      - dist/
deploy-staging:
  stage: deploy
  script:
    - echo "Time to deploy to staging"
#    - eval $(ssh-agent -s)
#    - ssh-add ~/.ssh/id_rsa
#    - ssh-add ~/.ssh/deploy_key
#    - export ANSIBLE_SSH_ARGS="-o ForwardAgent=yes"
#    - ansible-playbook -i provisioning/ansible-hosts provisioning/deploy-staging.yml
  environment:
    name: staging
    url: http://backoffice.duocircle.s2.isdemo.se
  only:
    - develop
